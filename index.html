<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YTWHZ ææ•ˆæµåª’ä½“ä¸­å¿ƒ | ç”µè§†ç›´æ’­ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/dplayer/dist/DPlayer.min.js"></script>
    <style>
        body { background: #0f172a; color: white; font-family: 'Inter', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        .channel-item:hover { background: rgba(56, 189, 248, 0.2); }
        #dplayer { border-radius: 1rem; overflow: hidden; background: #000; height: 400px; }
    </style>
</head>
<body class="p-4 md:p-8">
    <header class="max-w-7xl mx-auto mb-6 flex justify-between items-center">
        <div>
            <h1 class="text-3xl font-bold text-sky-400">YTWHZ TV HUB</h1>
            <p class="text-slate-400 text-xs">é›†æˆå…¨çƒåˆæ³•ç›´æ’­æº (M3U)</p>
        </div>
        <div id="timerDisplay" class="font-mono text-xl text-sky-400">00:00</div>
    </header>

    <main class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-4 gap-6">
        <div class="lg:col-span-3 space-y-6">
            <div id="dplayer"></div>
            
            <section class="glass p-6 rounded-2xl flex gap-3">
                <input id="searchInput" type="text" placeholder="æœç´¢ç”µå½±æˆ–å‰§é›†..." class="flex-1 bg-slate-800 border-none rounded-xl px-4 py-2 outline-none">
                <button onclick="multiSearch()" class="bg-sky-500 hover:bg-sky-400 px-6 py-2 rounded-xl font-bold transition">æœç´¢</button>
            </section>
        </div>

        <aside class="lg:col-span-1 glass rounded-3xl overflow-hidden flex flex-col" style="height: 520px;">
            <div class="p-4 bg-sky-500/10 border-b border-white/10">
                <h3 class="font-bold text-sky-400 flex items-center gap-2">ğŸ“º åœ¨çº¿ç›´æ’­æº</h3>
            </div>
            <div id="channelList" class="flex-1 overflow-y-auto p-2 space-y-1">
                <div class="p-8 text-center text-slate-500 text-sm">æ­£åœ¨åŠ è½½é¢‘é“åˆ—è¡¨...</div>
            </div>
        </aside>
    </main>

    <script>
        let dp;
        
        // åˆå§‹åŒ–æ’­æ”¾å™¨
        function initPlayer(url, title = 'æ­£åœ¨æ’­æ”¾') {
            dp = new DPlayer({
                container: document.getElementById('dplayer'),
                live: true,
                video: {
                    url: url,
                    type: 'hls'
                }
            });
            dp.play();
        }

        // è§£æ M3U å¹¶åŠ è½½é¢‘é“
        async function loadChannels() {
            const m3uUrl = 'https://raw.githubusercontent.com/Kimentanm/aptv/master/m3u/iptv.m3u';
            try {
                const response = await fetch(m3uUrl);
                const data = await response.text();
                const lines = data.split('\n');
                const channels = [];

                for (let i = 0; i < lines.length; i++) {
                    if (lines[i].startsWith('#EXTINF')) {
                        const title = lines[i].split(',')[1] || 'æœªçŸ¥é¢‘é“';
                        const url = lines[i + 1]?.trim();
                        if (url && url.startsWith('http')) {
                            channels.push({ title, url });
                        }
                    }
                }

                const listContainer = document.getElementById('channelList');
                listContainer.innerHTML = channels.map(ch => `
                    <div class="channel-item p-3 rounded-lg cursor-pointer text-sm transition" 
                         onclick="initPlayer('${ch.url}', '${ch.title}')">
                        <span class="text-slate-300">â–¶</span> ${ch.title}
                    </div>
                `).join('');

                // é»˜è®¤æ’­æ”¾ç¬¬ä¸€ä¸ªé¢‘é“
                if (channels.length > 0) initPlayer(channels[0].url, channels[0].title);

            } catch (err) {
                document.getElementById('channelList').innerHTML = '<div class="p-4 text-red-400 text-xs">åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¿é—® GitHub çš„æƒé™ã€‚</div>';
            }
        }

        function multiSearch() {
            const query = document.getElementById('searchInput').value;
            if (!query) return;
            window.open(`https://tubitv.com/search/${encodeURIComponent(query)}`, '_blank');
            window.open(`https://www.rottentomatoes.com/search?search=${encodeURIComponent(query)}`, '_blank');
        }

        // é¡µé¢åŠ è½½åæ‰§è¡Œ
        window.onload = loadChannels;
    </script>
</body>
</html>
